import{d as K,r as c,e as n,o as f,j as x,w as a,f as t,b as e,t as S,g as v,q as ae,E as te,p as le,h as se,_ as Q,a as ne,c as z,i as oe,F as O,s as ce,v as ue}from"./index-Rub71TYy.js";import{B as ie}from"./bread_crumb-4a3FFmDt.js";import{b as W}from"./mitt-ERXh4EJ-.js";import{f as R,h as re,i as P,g as de,U as pe,j as G,k as _e,l as me,m as H,n as ve,t as ge}from"./user-B5O29gJi.js";import{o as J}from"./operation_log-jDFuVYa0.js";import"./index-eBEV3ODV.js";const X=k=>(le("data-v-e10f8a53"),k=k(),se(),k),fe={class:"dialog-wrapper"},he={class:"dialog-left"},be={class:"dialog-right"},ye={class:"status"},we={class:"info-wrapper"},Ue=X(()=>t("span",null,"用户部门：",-1)),Ce={class:"info-content"},Ve={class:"info-wrapper"},xe=X(()=>t("span",null,"用户职位：",-1)),ke={class:"info-content"},Be=K({__name:"user_info",emits:["success"],setup(k,{expose:M,emit:h}){W.on("info",r=>{o.value=r.id,w.value=r.image_url,$.value=r.name,B.value=r.account,m.value=r.status,D.value=r.email,U.value=r.department,b.value=r.position});const o=c(),w=c(),$=c(),B=c(),D=c(),m=c(1),U=c(),I=h,u=async()=>{await R(o.value,U.value),I("success")},b=c(),E=async()=>{await R(o.value,void 0,b.value),I("success")},i=c(!1),A=()=>{ae.confirm("您确定要删除这个用户吗?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{const r=await re(o.value),p=`删除了用户${B.value}`;r.status==0?(await J(localStorage.getItem("account"),localStorage.getItem("name"),p,"高级","成功"),I("success"),i.value=!1):(await J(localStorage.getItem("account"),localStorage.getItem("name"),p,"高级","失败"),i.value=!1)}).catch(()=>{te({type:"info",message:"取消删除"})})};return M({open:()=>{i.value=!0}}),(r,p)=>{const L=n("el-avatar"),C=n("el-col"),s=n("el-row"),_=n("el-tag"),V=n("el-option"),F=n("el-select"),N=n("el-dialog");return f(),x(N,{modelValue:i.value,"onUpdate:modelValue":p[2]||(p[2]=g=>i.value=g),title:"用户信息",width:"600px"},{footer:a(()=>[t("span",{class:"delete",onClick:A},"删除用户")]),default:a(()=>[t("div",fe,[t("div",he,[e(L,{shape:"square",size:178,src:w.value},null,8,["src"])]),t("div",be,[e(s,null,{default:a(()=>[e(C,{span:8},{default:a(()=>[t("span",null,"姓名："+S($.value),1)]),_:1}),e(C,{span:16},{default:a(()=>[t("span",null,"账号："+S(B.value),1)]),_:1})]),_:1}),e(s,null,{default:a(()=>[e(C,{span:8},{default:a(()=>[t("div",ye,[v("状态： "),m.value==1?(f(),x(_,{key:0,class:"ml-2"},{default:a(()=>[v("冻结")]),_:1})):(f(),x(_,{key:1,class:"ml-2",type:"success"},{default:a(()=>[v("正常")]),_:1}))])]),_:1}),e(C,{span:16},{default:a(()=>[t("span",null,"联系方式："+S(D.value),1)]),_:1})]),_:1}),t("div",we,[Ue,t("div",Ce,[e(F,{modelValue:U.value,"onUpdate:modelValue":p[0]||(p[0]=g=>U.value=g),onChange:u},{default:a(()=>[e(V,{label:"人事部",value:"人事部"}),e(V,{label:"组织部",value:"组织部"})]),_:1},8,["modelValue"])])]),t("div",Ve,[xe,t("div",ke,[e(F,{modelValue:b.value,"onUpdate:modelValue":p[1]||(p[1]=g=>b.value=g),onChange:E},{default:a(()=>[e(V,{label:"员工",value:"员工"}),e(V,{label:"经理",value:"经理"})]),_:1},8,["modelValue"])])])])])]),_:1},8,["modelValue"])}}}),Ie=Q(Be,[["__scopeId","data-v-e10f8a53"]]),Pe={class:"common-wrapper"},Se={class:"common-content"},$e={class:"table-header"},De={class:"left-header"},Le={class:"right-header"},Fe={class:"table-content"},Me={class:"button-content"},Ee={class:"table-footer"},Ae=K({__name:"index",setup(k){const M=c("用户管理"),h=c(),o=c([]),w=async()=>{o.value=await P(1)};w();const $=async()=>{o.value=await P(u.currentPage)},B=async()=>{o.value=await de(h.value)},D=c(["人事部","开发部"]),m=c(),U=async()=>{const s=await pe(m.value);u.pageCount=Math.ceil(s.length/10),o.value=await G(1,m.value),u.currentPage!==1&&(o.value=await G(u.currentPage,m.value))},I=()=>{w()},u=ne({pageCount:1,currentPage:1}),b=async()=>{const s=await _e();u.pageCount=Math.ceil(s.length/10)};b();const E=async s=>{u.currentPage=s,o.value=await P(s)},i=c(),A=async()=>{const s=await me(i.value);u.pageCount=Math.ceil(s.length/10),o.value=await H(1,i.value),u.currentPage!==1&&(o.value=await H(u.currentPage,i.value))},j=async s=>{(await ve(s)).status==0&&(o.value=await P(u.currentPage))},r=async s=>{(await ge(s)).status==0&&(o.value=await P(u.currentPage))},p=()=>{h.value&&(h.value=null),i.value&&(i.value=null),m.value&&(m.value=null),w(),b()},L=c(),C=s=>{W.emit("info",s),L.value.open()};return(s,_)=>{const V=n("el-input"),F=n("el-option"),N=n("el-select"),g=n("el-radio"),Y=n("el-radio-group"),T=n("el-button"),d=n("el-table-column"),q=n("el-tag"),Z=n("el-table"),ee=n("el-pagination");return f(),z(O,null,[e(ie,{name:M.value},null,8,["name"]),t("div",Pe,[t("div",Se,[t("div",$e,[t("div",De,[e(V,{modelValue:h.value,"onUpdate:modelValue":_[0]||(_[0]=l=>h.value=l),class:"w-50 m-2 distance",placeholder:"输入账号进行搜索","suffix-icon":oe(ce),onChange:B},null,8,["modelValue","suffix-icon"]),e(N,{class:"distance",modelValue:m.value,"onUpdate:modelValue":_[1]||(_[1]=l=>m.value=l),placeholder:"请选择部门",clearable:"",onChange:U,onClear:I},{default:a(()=>[(f(!0),z(O,null,ue(D.value,l=>(f(),x(F,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(Y,{modelValue:i.value,"onUpdate:modelValue":_[2]||(_[2]=l=>i.value=l),class:"ml-4 distance",onChange:A},{default:a(()=>[e(g,{label:"1"},{default:a(()=>[v("冻结")]),_:1}),e(g,{label:"0"},{default:a(()=>[v("正常")]),_:1})]),_:1},8,["modelValue"])]),t("div",Le,[e(T,{type:"primary",onClick:p},{default:a(()=>[v("所有用户")]),_:1})])]),t("div",Fe,[e(Z,{data:o.value,style:{width:"100%"},border:"",onRowDblclick:C},{default:a(()=>[e(d,{type:"index",width:"50"}),e(d,{prop:"account",label:"账号",width:"100"}),e(d,{prop:"name",label:"姓名"}),e(d,{prop:"age",label:"年龄"}),e(d,{prop:"sex",label:"性别"}),e(d,{prop:"department",label:"部门"}),e(d,{prop:"position",label:"职位"}),e(d,{prop:"email",label:"邮箱",width:"150"}),e(d,{prop:"status",label:"状态"},{default:a(({row:l})=>[l.status=="1"?(f(),x(q,{key:0,class:"ml-2"},{default:a(()=>[v("冻结")]),_:1})):(f(),x(q,{key:1,class:"ml-2",type:"success"},{default:a(()=>[v("正常")]),_:1}))]),_:1}),e(d,{prop:"create_time",label:"创建时间",width:"150"},{default:a(({row:l})=>{var y;return[t("div",null,S((y=l.create_time)==null?void 0:y.slice(0,10)),1)]}),_:1}),e(d,{prop:"update_time",label:"更新时间",width:"150"},{default:a(({row:l})=>{var y;return[t("div",null,S((y=l.update_time)==null?void 0:y.slice(0,10)),1)]}),_:1}),e(d,{label:"操作",width:"200",fixed:"right"},{default:a(({row:l})=>[t("div",Me,[e(T,{type:"primary",onClick:y=>j(l.id),disabled:l.status==1},{default:a(()=>[v("冻结 ")]),_:2},1032,["onClick","disabled"]),e(T,{type:"success",onClick:y=>r(l.id),disabled:l.status==0},{default:a(()=>[v("解冻 ")]),_:2},1032,["onClick","disabled"])])]),_:1})]),_:1},8,["data"])]),t("div",Ee,[e(ee,{"current-page":u.currentPage,"pager-count":7,"page-count":u.pageCount,onCurrentChange:E,layout:"prev, pager, next"},null,8,["current-page","page-count"])])])]),e(Ie,{ref_key:"userInfo",ref:L,onSuccess:$},null,512)],64)}}}),Re=Q(Ae,[["__scopeId","data-v-59f108d5"]]);export{Re as default};
